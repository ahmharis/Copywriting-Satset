<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Copywriting Satset</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .custom-select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

    <div class="w-full max-w-4xl bg-white rounded-2xl shadow-lg p-6 md:p-10 space-y-8">
        <div class="text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800">AI Copywriting Satset</h1>
            <p class="text-gray-500 mt-2">Bikin copywriting menarik dalam hitungan detik ‚è∞ by @handialbanjary</p>
        </div>

        <div class="space-y-6">
            <div>
                <label for="product-description" class="block text-sm font-medium text-gray-700 mb-2">Deskripsikan produk, layanan, atau topik Anda:</label>
                <textarea id="product-description" rows="4" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="Contoh: Kopi bubuk Robusta premium dari lereng gunung, diproses secara alami, cocok untuk penikmat kopi sejati."></textarea>
            </div>
            <div>
                <label for="target-audience" class="block text-sm font-medium text-gray-700 mb-2">Target Penonton/Audiens:</label>
                <textarea id="target-audience" rows="2" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="Contoh: Mahasiswa, pekerja kantoran, usia 20-35 tahun, pencinta kopi."></textarea>
            </div>
            <div>
                <label for="cta-goals" class="block text-sm font-medium text-gray-700 mb-2">CTA (Call to Action) / Goals:</label>
                <textarea id="cta-goals" rows="2" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="Contoh: Ajak untuk membeli, klik link di bio, daftar webinar, kunjungi website."></textarea>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                    <label for="purpose" class="block text-sm font-medium text-gray-700 mb-2">1. Peruntukan</label>
                    <select id="purpose" class="w-full p-3 border border-gray-300 rounded-lg appearance-none custom-select focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                        <option>Video Reels/Tiktok</option>
                        <option>Video Youtube</option>
                        <option>Script Teks</option>
                        <option>Status Facebook</option>
                        <option>Status Threads/X</option>
                        <option>Carousel Instagram</option>
                        <option>Feed Single Post</option>
                        <option>Caption</option>
                        <option>Chat WA</option>
                    </select>
                </div>
                <div>
                    <label for="formula" class="block text-sm font-medium text-gray-700 mb-2">2. Formula Copywriting</label>
                    <select id="formula" class="w-full p-3 border border-gray-300 rounded-lg appearance-none custom-select focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                        <option>AIDA (Attention, Interest, Desire, Action)</option>
                        <option>PAS (Problem, Agitate, Solve)</option>
                        <option>FAB (Features, Advantages, Benefits)</option>
                        <option>PPPP (Picture, Promise, Prove, Push)</option>
                        <option>BAB (Before, After, Bridge)</option>
                        <option>The Star-Story-Solution Formula</option>
                        <option>ACCA (Awareness, Comprehension, Conviction, Action)</option>
                        <option>4C (Clear, Concise, Compelling, Credible)</option>
                        <option>GRAB (Gain attention, Relate, Agitate, Bridge)</option>
                        <option>PASTOR (Person, Aspiration, Story, Testimony, Offer, Request)</option>
                        <option>QUEST (Qualify, Understand, Educate, Stimulate, Transition)</option>
                        <option>SLAP (Stop, Look, Act, Purchase)</option>
                        <option>AICPBSAWN (Attention, Interest, Credibility, Proof, Benefit, Scarcity, Action, Warn, Now)</option>
                    </select>
                </div>
                <div>
                    <label for="hook" class="block text-sm font-medium text-gray-700 mb-2">3. Hook</label>
                    <select id="hook" class="w-full p-3 border border-gray-300 rounded-lg appearance-none custom-select focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                        <option>Negatif, Positif</option>
                        <option>Problem, Solution</option>
                        <option>Before, After</option>
                        <option>Manfaat Langsung (Direct Benefit)</option>
                        <option>Angka atau Daftar (Numbered List)</option>
                        <option>Pertanyaan (Question)</option>
                        <option>Perintah (Command)</option>
                        <option>Rasa Penasaran & Kejutan (Curiosity & Intrigue)</option>
                        <option>Berita atau Pengumuman (News/Announcement)</option>
                        <option>Bukti Sosial & Testimonial (Social Proof)</option>
                        <option>Urgensi & Kelangkaan (Urgency & Scarcity)</option>
                        <option>Dulu.., Sekarang...</option>
                    </select>
                </div>
            </div>
        </div>

        <div>
            <button id="generate-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition duration-300 ease-in-out flex items-center justify-center space-x-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-wand-sparkles"><path d="m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L11.8 9.2a1.21 1.21 0 0 0 0 1.72l5.8 5.8a1.21 1.21 0 0 0 1.72 0l6.84-6.84a1.21 1.21 0 0 0 0-1.72Z"/><path d="m14 7 3 3"/><path d="M5 6v4"/><path d="M19 14v4"/><path d="M10 2v2"/><path d="M7 8H3"/><path d="M14 17H9"/><path d="M17 17H9"/></svg>
                <span>Buat Copywriting</span>
            </button>
        </div>

        <div id="output-container" class="bg-gray-50 p-6 rounded-lg border border-gray-200 min-h-[200px] relative hidden">
             <div id="loader" class="absolute inset-0 flex items-center justify-center bg-white/70 rounded-lg">
                <div class="loader"></div>
            </div>
            <div id="result-header" class="flex justify-between items-center mb-4 hidden">
                <h3 class="text-lg font-semibold text-gray-800">Hasil Copywriting:</h3>
                <button id="copy-btn" class="bg-gray-200 text-gray-700 text-sm font-medium py-1 px-3 rounded-md hover:bg-gray-300 transition flex items-center space-x-1">
                     <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                     <span>Salin</span>
                </button>
            </div>
            <div id="result-text" class="text-gray-700 whitespace-pre-wrap"></div>
        </div>
    </div>

    <script>
        const generateBtn = document.getElementById('generate-btn');
        const productDescription = document.getElementById('product-description');
        const targetAudience = document.getElementById('target-audience');
        const ctaGoals = document.getElementById('cta-goals');
        const purposeSelect = document.getElementById('purpose');
        const formulaSelect = document.getElementById('formula');
        const hookSelect = document.getElementById('hook');
        const outputContainer = document.getElementById('output-container');
        const loader = document.getElementById('loader');
        const resultHeader = document.getElementById('result-header');
        const resultText = document.getElementById('result-text');
        const copyBtn = document.getElementById('copy-btn');

        const callGenerateApi = async (prompt, retries = 3, delay = 1000) => {
            const backendUrl = '/api/generate';

            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(backendUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ prompt: prompt })
                    });

                    if (!response.ok) {
                         const errorResult = await response.json();
                        throw new Error(errorResult.error || `HTTP error! status: ${response.status}`);
                    }

                    const result = await response.json();
                    return result.text;

                } catch (error) {
                    console.error(`Attempt ${i + 1} failed:`, error);
                    if (i === retries - 1) {
                         return `Maaf, terjadi kesalahan: ${error.message}. Silakan coba lagi nanti.`;
                    }
                    await new Promise(res => setTimeout(res, delay * Math.pow(2, i)));
                }
            }
        };

        generateBtn.addEventListener('click', async () => {
            const description = productDescription.value.trim();
            const audience = targetAudience.value.trim();
            const cta = ctaGoals.value.trim();

            if (!description || !audience || !cta) {
                alert("Mohon lengkapi semua kolom (deskripsi, target audiens, dan CTA).");
                return;
            }

            const purpose = purposeSelect.value;
            const formula = formulaSelect.value;
            const hook = hookSelect.value;
            
            outputContainer.classList.remove('hidden');
            loader.classList.remove('hidden');
            resultHeader.classList.add('hidden');
            resultText.textContent = '';
            generateBtn.disabled = true;
            generateBtn.classList.add('opacity-50', 'cursor-not-allowed');

            const systemPrompt = `Anda adalah seorang ahli copywriting profesional berbahasa Indonesia. Tugas Anda adalah membuat salinan (copy) yang sangat menarik berdasarkan detail yang diberikan. Pastikan gaya bahasa dan formatnya sesuai dengan platform yang dituju. Hasilkan HANYA teks copywritingnya saja, tanpa penjelasan atau judul tambahan.`;
            const userPrompt = `
                Deskripsi Produk/Topik: "${description}"
                Target Penonton/Audiens: "${audience}"
                CTA (Call to Action) / Goals: "${cta}"
                Peruntukan / Platform: ${purpose}
                Formula Copywriting yang Digunakan: ${formula}
                Gaya Hook (Kail) yang Digunakan: ${hook}
                Buatkan copywritingnya sekarang.
            `;
            const fullPrompt = `${systemPrompt}\n\n${userPrompt}`;

            const generatedText = await callGenerateApi(fullPrompt);

            resultText.textContent = generatedText.trim();
            loader.classList.add('hidden');
            resultHeader.classList.remove('hidden');
            
            generateBtn.disabled = false;
            generateBtn.classList.remove('opacity-50', 'cursor-not-allowed');
        });

        copyBtn.addEventListener('click', () => {
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = resultText.textContent;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            try {
                 document.execCommand('copy');
                const originalBtnText = copyBtn.querySelector('span').textContent;
                copyBtn.querySelector('span').textContent = 'Tersalin!';
                setTimeout(() => {
                    copyBtn.querySelector('span').textContent = originalBtnText;
                }, 2000);
            } catch (err) {
                console.error('Gagal menyalin teks: ', err);
                alert('Gagal menyalin teks. Silakan salin secara manual.');
            }
            document.body.removeChild(tempTextArea);
        });
    </script>
</body>
</html>
